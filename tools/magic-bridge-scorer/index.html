<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title
      data-en="Magic Bridge Scorer"
      data-zh-HK="數字牌遊戲計分工具"
    >
      Magic Bridge Scorer
    </title>
    <link rel="stylesheet" href="../../assets/style.css" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header id="siteHeader" class="site-header"></header>

    <main class="scorer-container">
      <div class="scorer-heading">
        <h1
          data-en="Magic Bridge Scorer"
          data-zh-HK="數字牌遊戲計分工具"
        >
          Magic Bridge Scorer
        </h1>
        <p
          class="subtitle"
          data-en="Score calculator for tile-based number games"
          data-zh-HK="數字牌遊戲計分工具"
        >
          Score calculator for tile-based number games
        </p>
      </div>

      <div class="main-layout">
        <!-- Slot Management Panel -->
        <aside class="slot-panel" id="slotPanel">
          <div class="slot-panel-header">
            <h2
              data-en="Game Slots"
              data-zh-HK="遊戲槽位"
            >
              Game Slots
            </h2>
            <button
              id="toggleSlotPanel"
              class="btn-icon"
              aria-label="Toggle panel"
              title="Toggle panel"
            >
              <span id="toggleIcon">−</span>
            </button>
          </div>
          <div class="slot-panel-content" id="slotPanelContent">
            <button
              id="createSlotBtn"
              class="btn btn-primary"
              data-en="+ New Game"
              data-zh-HK="+ 新遊戲"
            >
              + New Game
            </button>
            <div id="slotList" class="slot-list"></div>
          </div>
        </aside>

        <!-- Main Content Area -->
        <div class="content-area">
          <!-- Current Slot Info -->
          <div class="current-slot-info" id="currentSlotInfo">
            <span
              class="slot-name"
              data-en="No game selected"
              data-zh-HK="未選擇遊戲"
            >
              No game selected
            </span>
            <span class="save-indicator" id="saveIndicator">
              <span
                data-en="Saved"
                data-zh-HK="已保存"
              >
                Saved
              </span>
            </span>
          </div>

          <!-- Player Management -->
          <section class="player-management">
            <h2
              data-en="Players"
              data-zh-HK="玩家"
            >
              Players
            </h2>
            <div class="add-player-section">
              <input
                type="text"
                id="newPlayerName"
                placeholder="Player name"
                data-placeholder-en="Player name"
                data-placeholder-zh-Hant="玩家名稱"
              />
              <button
                id="addPlayerBtn"
                class="btn btn-primary"
                data-en="Add Player"
                data-zh-HK="添加玩家"
              >
                Add Player
              </button>
            </div>
            <div id="playerList" class="player-list"></div>
          </section>

          <!-- Scoring Section -->
          <section class="scoring-section" id="scoringSection">
            <h2
              data-en="Current Round"
              data-zh-HK="當前回合"
            >
              Current Round
            </h2>
            <div id="playerScoringAreas" class="player-scoring-areas"></div>
            <div class="round-controls">
              <button
                id="calculateBtn"
                class="btn btn-primary"
                data-en="Calculate Scores"
                data-zh-HK="計算分數"
              >
                Calculate Scores
              </button>
              <button
                id="resetRoundBtn"
                class="btn btn-secondary"
                data-en="Reset Round"
                data-zh-HK="重置回合"
              >
                Reset Round
              </button>
              <button
                id="newRoundBtn"
                class="btn btn-secondary"
                data-en="New Round"
                data-zh-HK="新回合"
              >
                New Round
              </button>
              <button
                id="shareBtn"
                class="btn btn-secondary"
                data-en="Share"
                data-zh-HK="分享"
              >
                Share
              </button>
            </div>
          </section>

          <!-- Results Section -->
          <section class="results-section" id="resultsSection" style="display: none">
            <h2
              data-en="Round Results"
              data-zh-HK="回合結果"
            >
              Round Results
            </h2>
            <div id="resultsContent" class="results-content"></div>
          </section>

          <!-- Rounds History -->
          <section class="rounds-history" id="roundsHistory" style="display: none">
            <h2
              data-en="Rounds History"
              data-zh-HK="回合歷史"
            >
              Rounds History
            </h2>
            <div id="roundsList" class="rounds-list"></div>
            <!-- Settlement Section -->
            <div class="settlement-section" id="settlementSection" style="display: none">
              <h3
                data-en="Settlement"
                data-zh-HK="結算"
              >
                Settlement
              </h3>
              <div id="settlementContent" class="settlement-content"></div>
            </div>
          </section>
        </div>
      </div>
    </main>

    <!-- Modals -->
    <!-- Create/Edit Slot Modal -->
    <div id="slotModal" class="modal" style="display: none">
      <div class="modal-content">
        <div class="modal-header">
          <h3
            id="slotModalTitle"
            data-en="New Game"
            data-zh-HK="新遊戲"
          >
            New Game
          </h3>
          <button class="modal-close" id="closeSlotModal">&times;</button>
        </div>
        <div class="modal-body">
          <label
            for="slotNameInput"
            data-en="Game Name:"
            data-zh-HK="遊戲名稱:"
          >
            Game Name:
          </label>
          <input
            type="text"
            id="slotNameInput"
            placeholder="Enter game name"
            data-placeholder-en="Enter game name"
            data-placeholder-zh-Hant="輸入遊戲名稱"
          />
        </div>
        <div class="modal-footer">
          <button
            id="saveSlotBtn"
            class="btn btn-primary"
            data-en="Save"
            data-zh-HK="保存"
          >
            Save
          </button>
          <button
            id="cancelSlotBtn"
            class="btn btn-secondary"
            data-en="Cancel"
            data-zh-HK="取消"
          >
            Cancel
          </button>
        </div>
      </div>
    </div>

    <!-- Share Modal -->
    <div id="shareModal" class="modal" style="display: none">
      <div class="modal-content">
        <div class="modal-header">
          <h3
            data-en="Share Game"
            data-zh-HK="分享遊戲"
          >
            Share Game
          </h3>
          <button class="modal-close" id="closeShareModal">&times;</button>
        </div>
        <div class="modal-body">
          <label
            for="shareLinkInput"
            data-en="Share Link:"
            data-zh-HK="分享連結:"
          >
            Share Link:
          </label>
          <div class="share-link-container">
            <input
              type="text"
              id="shareLinkInput"
              readonly
            />
            <button
              id="copyShareLinkBtn"
              class="btn btn-primary"
              data-en="Copy"
              data-zh-HK="複製"
            >
              Copy
            </button>
          </div>
        </div>
      </div>
    </div>

    <script type="module" src="scorer.js"></script>
    <script type="module">
      import { initThemeToggle } from "../../assets/theme-toggle.js";
      import { initLocaleMenu } from "../../assets/locale-menu.js";
      import { initHeader } from "../../assets/header.js";

      initHeader("../../index.html");
      initThemeToggle();
      initLocaleMenu({
        onLocaleChange: () => {
          // Trigger localechange event for our listeners
          document.dispatchEvent(new Event("localechange"));
        },
      });
    </script>
  </body>
</html>

